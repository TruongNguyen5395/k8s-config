Vagrant.configure("2") do |config|
  config.vm.box = "bento/ubuntu-20.10" 
  config.ssh.username = 'vagrant'
  config.ssh.password = 'vagrant'
  config.ssh.insert_key = 'true'


  config.vm.define "nfs" do |nfs|
    nfs.vm.network "private_network", ip: "10.10.1.2" 
    nfs.vm.hostname = "nfs"

    nfs.vm.provider "virtualbox" do |vb|
      vb.memory = "4096"
      vb.cpus = 4
    end
  end

  config.vm.define "kube-0" do |kube_0| 
    kube_0.vm.network "private_network", ip: "10.10.1.3" 
    kube_0.vm.hostname = "kube-0"

    kube_0.vm.provider "virtualbox" do |vb|
      vb.memory = "4096"
      vb.cpus = 4
    end
  end

  config.vm.define "kube-1" do |kube_1| 
    kube_1.vm.hostname = "kube-1"
    kube_1.vm.network "private_network", ip: "10.10.1.4"  
    kube_1.vm.provider "virtualbox" do |vb|
      vb.memory = "4096"
      vb.cpus = 4
    end
  end


  config.vm.provision "ansible" do |ansible| 
    # ansible.verbose = "-vvvv"
    ansible.galaxy_role_file = 'requirements.yml'
    ansible.playbook = "playbook.yml"
    ansible.inventory_path = "inventory.yml"
    # ansible.limit = "all"
    ansible.tags = ["k3s"]
  end


  # config.vm.provision "ansible" do |ansible|
  #   ansible.playbook = "../config/playbook.yml"
  #   ansible.inventory_path = "inventory.yml" 
  # end
end